<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/style.css">
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/layout_dashboard.css">
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/type_dashboard.css">
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/component_dashboard.css">
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/animate.css">
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/color.css">
	<link rel="stylesheet" type="text/css" href="res/dashboard/css/chart.css">
</head>
<body class="light_blue_bg">
	<!--Top Navigation-->
	<div class="navbar-header dark_highlight_bg white_highlight">
		<!--Wrapper live area-->
		<div class="live_area">
			<ul class="nav navbar-top-links" id="top_navigation">
				<li><a href="index.html">현황</a></li>
				<li><a href="topology_1.html">토폴로지</a></li>
				<li><a>플로우</a></li>
				<li><a>위협</a></li>
				<li><a>시스템</a></li>
		</ul>
		</div>
		<!--Wrapper live area-->
	</div>
	<!--Top Navigation-->

	<!--Conent Area-->
	<div class="live_area">
		<!--Flow Chart Section-->
		<h2 class="header_section dark_highlight">
			현황
		</h2>
		<p>
			각 노드의 플로우 및 위협 이벤트 현황들을 확인합니다.
		</p>
		<div class="flex_row col1 space_between">
			<div class="col2_mg_1x flex_row_child ibox content_container">
				<div class="ibox-title">
					애플리케이션 플로우 차트
				</div>
				<div class="col1 ibox-content bright_blue_bg" id="appFlow">
					<div class="flex_row col1 margin_bottom_2x" id="appFlowChartLegend"></div>
					<div class="flex_row col1">
						<div class="flex_col align_center left_align col2">
							<strong class="m-b-xs">
								수신.전송 데이터랑
							</strong>
							<div class="col1" id="appFlowData">
								
							</div>
							<div class="flex_row col1 justify_center margin_bottom_2x" id="appFlowDataLegend">
						</div>
						</div>
						<div class="flex_row col2 text_center">
							<strong class="m-b-xs col1 left_align" style="height: 19px">평균 응답속도</strong>
							<div class="col2 left_align" id="appMeanResRateChart" style="width:70%"></div>
							<div class="col2 left_align flex_col flex_center text_center" style="width:30%">
								<div class="col1 flex_row flex_center" id="appFlowResponseSpeed">
									<h1 style="display: inline-block;"><strong id="app_mean_res_rate"></strong></h1>
									<span>&nbsp;ms</span><br>
									<p class="col1 text_center" id="app_mean_res_level"></p>
								</div>
							</div>
						</div>
					</div>
					<div class="flex_col col1" id="appFlowChart">
					</div>
				</div>
			</div>
			<div class="col2_mg_1x flex_row_child ibox content_container">
				<div class="ibox-title">
					일반 플로우 차트
				</div>
				<div class="col1 ibox-content bright_blue_bg" id="generalFlow">
					<div class="flex_row col1 margin_bottom_2x" id="generalFlowChartLegend">
					</div>
					<div class="flex_row col1">
						<div class="flex_col left_align align_center col2">
							<strong class="m-b-xs">
								수신.전송 데이터랑
							</strong>
							<div class="col1" id="generalFlowData">
							</div>
							<div class="flex_row col1 justify_center margin_bottom_2x" id="generalFlowDataLegend">
							</div>
						</div>
						<div class="flex_row col2 text_center">
							<strong class="m-b-xs col1 left_align" style="height: 19px">평균 응답속도</strong>
							<div class="col2 left_align" id="generalMeanResRateChart" style="width:70%"></div>
							<div class="col2 left_align flex_col flex_center text_center" style="width:30%">
								<div class="col1 flex_row flex_center" id="generalFlowReponseSpeed">
									<h1 style="display: inline-block;"><strong id="general_mean_res_rate"></strong></h1>
									<span>&nbsp;ms</span>
									<p class="col1 text_center" id="general_mean_res_level"></p>
								</div>
							</div>
						</div>
					</div>
					<div class="flex_col col1" id="generalFlowChart">
					</div>
				</div>
			</div>
		</div>
		<!--Flow Chart Section-->
		<!--Key Measurement Cards Section-->
		<div class="flex_row col1 space_between">
			<div class="col_6_13_mg_1x ibox">
				<h2 class="header_section dark_highlight">
					위협 이벤트
				</h2>
				<div class="flex_row col1 space_between" id="threatEvent">
				</div>
			</div>
			<div class="col_7_13_mg_1x ibox">
				<h2 class="header_section dark_highlight">
					시스템 운영지표
				</h2>
				<div class="flex_row col1 space_between" id="systemMeasurement">
				</div>
			</div>
		</div>
		<!--Key Measurement Cards Section-->

		<!--STATUS ANLYASIS-->
		<!--STATUS ANLYASIS-->
		<!--STATUS ANLYASIS-->
		<h2 class="header_section dark_highlight">
			지표분석
		</h2>
		<p>
			16개의 주요 지표에대한 분석을 비교합니다.
		</p>
		<div class="flex_row col1 space_between" id="statusAnalysis">
		</div>
		<!--STATUS ANLYASIS-->
		<!--STATUS ANLYASIS-->
		<!--STATUS ANLYASIS-->

	</div>
</body>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.js"></script> -->
<!-- <script type="text/javascript" src="https://d3js.org/d3.v5.min.js"></script> -->
<script type="text/javascript" src="res/dashboard/js/d3.js"></script>
<script type="text/javascript" src="https://d3js.org/d3-random.v2.min.js"></script>
<!-- <script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
<script src="https://d3js.org/d3-quadtree.v1.min.js"></script>
<script src="https://d3js.org/d3-timer.v1.min.js"></script>
<script src="https://d3js.org/d3-force.v2.min.js"></script> -->
<script type="text/javascript">
	
	$(document).ready(function(){
		var duration = 1100;
		/*FLOW CHART SECTION - START*/
		/*GET FLOW CHART DATA*/

		$.get("http://210.96.184.227:8282/json/application_flow", function(data){
			var flowData = jQuery.parseJSON(data).DATA;
			console.log(flowData);
			setAppFlowChart(flowData);

		},'html');

		/*Interval Load for Update*/
		var updateAppFlowData = function(){
			$.get("http://210.96.184.227:8282/json/application_flow", function(data){
				var flowData = jQuery.parseJSON(data).DATA;
				updateAppFlowChart(flowData);
			},'html');
		}
		//setInterval(updateAppFlowData, duration);


		

		/*FLOW CHART SECTION - START*/
		/*GET FLOW CHART DATA*/
		$.get("http://210.96.184.227:8282/json/generation_flow", function(data){
			var flowData = jQuery.parseJSON(data).DATA;
			setGeneralFlowChart(flowData);
		},'html');
		/*Interval Load for Update*/
		var updateGeneralFlowData = function(){
			$.get("http://210.96.184.227:8282/json/application_flow", function(data){
				var flowData = jQuery.parseJSON(data).DATA;
				updateGeneralFlowChart(flowData);
			},'html');
		}
		//setInterval(updateGeneralFlowData, duration);


		/*THREAT EVENT  SECTION - START*/
		/*GET THREAT EVENT DATA*/
		$.get("http://210.96.184.227:8282/json/threat_event", function(data){
			// var threatEventData = jQuery.parseJSON(data).DATA;
			var threatEventData = data.DATA;
			setThreatEvent(threatEventData);
		});
		/*Interval Load for Update*/
		var updateThreatEventData = function(){
			$.get("http://210.96.184.227:8282/json/threat_event", function(data){
				// var threatEventData = jQuery.parseJSON(data).DATA;	
				var threatEventData = data.DATA;	
				updateThreatEvent(threatEventData);	
			});
		
		}
		//setInterval(updateThreatEventData, duration);
		

		/*THREAT EVENT  SECTION - START*/
		/*GET THREAT EVENT DATA*/
		$.get("http://210.96.184.227:8282/json/system_manage_indicator", function(data){
			// var systemIndicatorData = jQuery.parseJSON(data).DATA;
			var systemIndicatorData = data.DATA;
			setSystemManageIndicator(systemIndicatorData);
		});
		/*Interval Load for Update*/
		var updateSystemManageIndicatorData = function(){
			$.get("http://210.96.184.227:8282/json/system_manage_indicator", function(data){
				// var systemIndicatorData = jQuery.parseJSON(data).DATA;
				var systemIndicatorData = data.DATA;
				updateSystemManageIndicator(systemIndicatorData);
			});
		}
		//setInterval(updateSystemManageIndicatorData, duration);


		/*Line Graph for System Status*/
		var indicator_basic_url = "http://210.96.184.227:8282/json/indicator";
		var status_list = [

		{
			"title":"접속차단지표",
			"title_eng":"ind_accessBlock",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"위험차단지표",
			"title_eng":"ind_threatBlock",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"네트워크 플로우지표",
			"title_eng":"ind_networkFlow",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"네트워크 응답 품질",
			"title_eng":"ind_networkQuality",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"사용자 지표",
			"title_eng":"ind_user",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"애플리케이션 지표",
			"title_eng":"ind_app",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"네트워크 전송 데이터 지표",
			"title_eng":"ind_resData",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"네트워크 수신 데이터 지표",
			"title_eng":"ind_reqData",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"서비스 지표",
			"title_eng":"ind_service",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"출발지 노드 지표",
			"title_eng":"ind_departure",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"도착지 노드 지표",
			"title_eng":"ind_arrival",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"자원 사용지표",
			"title_eng":"ind_resource",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"CPU",
			"title_eng":"ind_cpu",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"메모리",
			"title_eng":"ind_memory",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"네트워크",
			"title_eng":"ind_network",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		},
		{
			"title":"스토리지",
			"title_eng":"ind_storage",
			"data":[],
			"indicator_Xmax":0,
			"indicator_current_x":0,
			"scaleObject":{
				xScale:null,
				ySale:null,
				xAxis:null
			},
			"line":null,
			"area":null
		}
];
		
		setSystemIndicatorDiv(status_list);

		status_list.forEach(function(status_item){
			$.get(indicator_basic_url + "?id=" + status_item.title_eng, function(data){
				var indicatorData = data.DATA;
				status_item.data;
				setSystemIndicator(status_item,indicatorData);
			});
		});
		var updateSystemIndicatorData = function(){
			status_list.forEach(function(status_item){
				$.get(indicator_basic_url + "?id=" + status_item.title_eng, function(data){
					var indicatorData = data.DATA;
					status_item.data;
					updateSystemIndicator(status_item,indicatorData);
				});
			});
		}
		//setInterval(updateSystemIndicatorData, duration);

		// setInterval(updateViz, duration);
		var sessionNum = 0;
		var sessionCheck = [];
		var isUpdate=false;
		var duration_offset = 50;
		sessionCheck.push(isUpdate);

		window.requestAFrame = (function() {

			alert(window.requestAnimationFrame);
			
			return window.requestAnimationFrame || 
				   window.webkitRequestAnimationFrame ||
				   window.mozRequestAnimationFrame ||
				   window.oRequestAnimationiFrame ||

				function(callback) {
					console.log("requestAFrame doesn't support");
					return window.setTimeout(callback, duration);
				};

		})();

		function updateViz(timeStamp){

			var sessionTime = timeStamp%duration;
			if((duration-duration_offset<sessionTime)&&(sessionCheck[sessionNum]==false)){
				updateAppFlowData();
				updateGeneralFlowData();
				updateThreatEventData();
				updateSystemManageIndicatorData();
				updateSystemIndicatorData();
				sessionCheck[sessionNum] = true;
				sessionNum++;
				sessionCheck.push(isUpdate);
			}
			window.requestAFrame(updateViz);
			// requestAnimationFrame(updateViz);
		}

		window.requestAFrame(updateViz);
		// requestAnimationFrame(updateViz);

	});
</script>
<script type="text/javascript" src="res/dashboard/js/appFlowChart2.js"></script>
<script type="text/javascript" src="res/dashboard/js/generalFlowChart.js"></script>
<script type="text/javascript" src="res/dashboard/js/keyMeasurement.js"></script>
<script type="text/javascript" src="res/dashboard/js/lineCharts.js"></script>
</html>